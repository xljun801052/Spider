"""
    一、对于大部分网页，我们如果没有登录的话是不能直接去爬取数据的。那么记录登录信息的cookie就显得尤为重要，如何在一个请求中携带cookie？
        1.实现利用网页登录后的cookie携带进行请求

        2.直接利用HTTPCookieProcessor实现代码登录网页进行请求

        3.爬虫登录后获取cookie并保存到文件中，后续从文件中获取cookie进行请求
            ①根据请求次序和请求数据判断获取登录的url
"""
from urllib.request import Request, urlopen
from fake_useragent import UserAgent
from urllib.parse import urlencode
from urllib.request import HTTPCookieProcessor, build_opener

# 首先要登录京东，获取cookie并保存在opener中
url1 = 'https://passport.jd.com/uc/loginService?uuid=71e4ee27-bc96-4425-b8f0-e98e74a9420d&&r=0.1479446965988782&version=2015'
url2 = 'https://passport.jd.com/new/login.aspx?ReturnUrl=https%3A%2F%2Fpro.jd.com%2Fmall%2Factive%2F7P8nSbxpPbTXJxvTSobyGWSjHAM%2Findex.html%3FbabelChannel%3Dttt4%26cu%3Dtrue%26utm_source%3Dtb.mkttracking.com%26utm_medium%3Dtuiguang%26utm_campaign%3Dt_16282_117786803%26utm_term%3D6843a8b31db746809e29f17fddc3178e'
headers = {
    'User-agent': UserAgent().chrome
}
login_data = {
    "uuid": "71e4ee27-bc96-4425-b8f0-e98e74a9420d",
    "eid": "GA7NMRX7KS4QM6DFHWA37MB6DQJIWEFWPR576Z6KUHYLRH2U3HVBWSSCQHXFWAVHCT3KVKWNGLRYZZLPU2ZPSJ6F7Y",
    "fp": "46932fa32ace57ee01c005ff26336268",
    "_t": "_t",
    "loginType": "c",
    "loginname": "夏李逸笙",
    "nloginpwd": "OOL4qeaeVQc4ibRfF3Fb3rcvBzIyzt9l8aYNXwsbPMZahoJV3jnbwvhLotX+YE3XJiv5O2xph8s58OdVHqfANbzRA7CcZHNIR0GoIBA36BRj630NshVTNkZbwtEtnpIAYYWPu+Wwk6yixKoj1LM61PbNU1SWviKDNIeSFlAn8S0=",
    "authcode": "9c04bdf36aea4e538783aeeb2d14c47c",
    "pubKey": "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDC7kw8r6tq43pwApYvkJ5laljaN9BZb21TAIfT/vexbobzH7Q8SUdP5uDPXEBKzOjx2L28y7Xs1d9v3tdPfKI2LR7PAzWBmDMn8riHrDDNpUpJnlAGUqJG9ooPn8j7YNpcxCa1iybOlc2kEhmJn5uwoanQq+CA6agNkqly2H4j6wIDAQAB",
    "sa_token": "B68C442BE645754F33277E7012080590A7E47FD675EC6B7A8867A47F2BDBF216D5F885038FDC0E844D5AB4CDD6A7273E555B8CBBFBFE3D332A07D1276136EF8B03DAC2ECAA63A0B2F560465F0ACA2B095DA8C59226D1C305936F1004939CF081C190DBC50C9C670B7D9522F10474D0ACE02E424A83D650FB4511C8FDABE1AE34ED03DF09F90C545E1268826ADD516BA74DBCCB1E10B13B96C0DC1B1B5488D7F7EAE5BB216EFE5A02384BFD4018F0F16822208C004362879762B25BDF460E59874E2504976320499D08EA227909AA2E0CB93FA5776B1CECDE0D5C6E087AFBFE340F8EB78D0463763D446FF5B133F0315D28A1C7DC7F1E0645FC321C096226EDA2EB535BDC6ED541E37C517B71228AC00440F8D83BB64E9AC9BF745426325EBE13B19A82CDAC052CE7F932BAA6D8ECA268022D1064B311949FB27D0C4B2BE2F5BB6BB3D26808CF3F36B55987223B90C1827039E7BDA3654623356282298AA5B4A3D0334A4A61FED0FD499B4122DCB2DE498BBF2C6F0EA95162CAE4099C2DDC1DCE11DCA17F974CC936B1C72D1FEF873CA9F0A62B8C39FE53CD839B2A2D4794E6BDA1A7C8297927CAEBD81BBF700B026B63",
    "seqSid": 231727264634538203,
    "useSlideAuthCode": 1,
    "antiBotToken": "ju5el424pcyit0u6d1016038021491590std~NmZeSyVEbFNSd3d+fFFfA3l9Bg1pRHpTBiUjb35DFm5vLUROOBEzLUF7G28iAAFBKBgVFA1EPwIVKDclGENXbm8iVlQiAwpTTx1lKSsTCG5vfmsaDUR6LUEnG29+PU8DeyEPWWJRZhBQeX8vfVhVU31wVlwwVDVAVnN0fXYAVQAicU5kc0oKUwoyKhFmWzEQOTZCXQ1Eei1BKTQ5GENXbm80VksiFjkDF28tKWoCAl8RZhtkcxY4LUF7G29rDwhFYihYXzgIeBAQMT8RZk0xED0waxprOnQZFzU3Pn49Tx4RZkdRDURsLUF4a35oU0EDfmgHFGVWClMeY2tvIQUJQSpmDRohFiQfQW1lLjdDVxAvNFVaNQ8/CQkuNToqDx1cfXdPQWkIYx8TOSY0dQ4aQDpxA0BzSnQSQXtlP3ENBgB4NllbMwgxGhU3InoyCVwEfXcPCGNXYkhSdH4nIREJEGFmU0s/RGxTUSV+dXwYVF9vaBVRIkRsU1Jja28uCA4Qd2YOAWhfdAw=|~1603802195989~1~20200318~eyJ2aXdlIjoiMCIsImJhaW4iOnsiaWMiOiIxIiwibGUiOiIxMDAiLCJjdCI6IjAiLCJkdCI6ImkifX0=~1~-117375~ei18|f-0d8x-0,0,0,0;ew2if;gw0;5di0-11c,5o,,;bd2s-11c,5o,2c,i;0d4-11c,5o,2c,i;50k0-xr,7r,,;701r-,,,;301-xr,7r,2z,m;b01-xr,7r,2z,m;902;002-xr,7r,2z,m;202hd;918;212;a14;511ty-z6,9e,,;612e-yv,9f,,;61a-yn,9f,,;616-ye,9f,,;618-y1,9f,,;618-xm,9f,,;61f-wi,9f,,;617-vz,9f,,;618-vg,9f,,;61h-um,9f,,;617-ud,9f,,;618-u4,9f,,;619-ty,9f,,;61h-tt,9f,,;716v-,,,;5dop-12x,9f,,;402o-12x,9f,85,2a;bd1-12x,9f,9,a;a01;0d4-12x,9f,9,a;5177-yz,9e,,;712m-,,,;310-yz,9e,47,l;b11-yz,9e,47,l;911;012-yz,9e,47,l;21o4;2193;2163;215i;21qi;21uu-8;21ew;217t;2166;214h;21cy;212u;218x;213b;a14a7;91dh3;553-ym,c0,,;753v-,,,;411-ym,c0,3u,37;350-ym,c0,3s,g;b51-ym,c0,3s,g;a11;952;051-ym,c0,3s,g;6d1sd-vs,a7,,;6d39-ws,a7,,;6dy0-10o,a7,,;6dp5-ya,a3,,;doei:,1,1,0,0,1,1000,-1000,1000,-1000;dmei:,1,1,1,1000,-1000,1000,-1000,1000,-1000;emc:,0:1,1:1,5:1,d:2;emmm:;emcf:,d:1,0:1,1:0,d:1,1:1,5:1;ivli:,0:4,1:12;iivl:,0:0,1:0;ivcvj:;scvje:;ewhi:,0:304-38,1:304-38,5:304-33;1603802149154,1603802195986,2,1,70,70,0,158,0,0,0;6t1y",
}
response = urlopen(Request(url2, headers=headers, data=urlencode(login_data).encode()))
print(response.read().decode('gbk'))


